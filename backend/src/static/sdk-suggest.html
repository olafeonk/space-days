<!doctype html>
<html lang="ru">

<head>
<meta charSet="utf-8" />
<meta name='viewport' content='width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, shrink-to-fit=no, viewport-fit=cover'>
<meta http-equiv='X-UA-Compatible' content='ie=edge'>
<style>
   html,
   body {
      background: #eee;
   }
</style>
<script src="https://yastatic.net/s3/passport-sdk/autofill/v1/sdk-suggest-with-polyfills-latest.js"></script>
</head>

<body>
   <script type="text/javascript">
      document.cookie = 'user=John; SameSite=None; Secure';
   window.onload = function() {
      window.YaAuthSuggest.init({
                  client_id: '66680f0be8644a6c8e560993fc0caff7',
                  response_type: 'token',
                  redirect_uri: 'https://fa5e-94-140-148-44.ngrok-free.app/token/'
               },
               'https://fa5e-94-140-148-44.ngrok-free.app/token/'
            )
            .then(function(result) {
               return result.handler()
            })
            .then(function(data) {
               console.log('Сообщение с токеном: ', data);
               const response = fetch(`https://fa5e-94-140-148-44.ngrok-free.app/authorize/?token=${data["access_token"]}`, {
                    method: "GET",
                    headers: {
                        "Content-Type": "application/json",
                    },
                });
               document.body.innerHTML += `Сообщение с токеном: ${JSON.stringify(data)}`;
            })
            .catch(function(error) {
               console.log('Что-то пошло не так: ', error);
               document.body.innerHTML += `Что-то пошло не так: ${JSON.stringify(error)}`;
            });
      };
   </script>
</body>

</html>